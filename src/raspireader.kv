#:kivy 1.10.0
#:import os os


<RootWidget>:
  id: rootwidget
  Header:
    id: header
    HeaderButtons:
      Button:
        text: "Start"
        on_press: root.ids.pagemanager.current = "startpage"
      Button:
        text: "Options"
        on_press: root.ids.pagemanager.current = "optionspage"
      Button:
        text: "Commit"
        on_press: root.ids.pagemanager.current = "commitpage"
      Button:
        text: "Backup"
        on_press: root.ids.pagemanager.current = "backuppage"
  PageLayer:
    id: pagelayer
    PageManager:
      id: pagemanager
      StartPage:
        id: sp
      OptionsPage:
        id: op
      CommitPage:
        id: cp
      BackupPage:
        id: bp
  Footer:
    id: footer
    FooterButtons:
      Button:
        text: "Print To Screen"
        on_press: root.print_to_screen()

<HeaderButtons>:
  orientation: "horizontal"
  size_hint: 1, 0.1

<Header>:
  anchor_x: "center"
  anchor_y: "top"

<PageLayer>:
  anchor_x: "center"
  anchor_y: "center"

<FooterButtons>:
  orientation: "horizontal"
  size_hint: 1, 0.1

<Footer>:
  anchor_x: "center"
  anchor_y: "bottom"

<PageManager>:
  size_hint: 1, .8

<StartPage>:
  name: "startpage"
  GridLayout:
    rows: 2
    Label:
      size_hint: 1, 0.1
      text: "Start Page"
    StackLayout:
      Label:
        size_hint: 0.2, None
        height: '32dp'
        text: "Image"
      TextInput:
        size_hint: .6, None
        height: '32dp'
        multiline: False
        disabled: True
        id: iso_label
        text: root.iso_file
      Button:
        size_hint: .2, None
        height: '32dp'
        text: "Load"
        on_release: root.file_pick()
      Label:
        size_hint: 0.2, None
        height: '32dp'
        text: "Download"
      Button:
        size_hint: .6, None
        height: '32dp'
        id: download_image
        text: root.download_file
        on_release: root.download_pick()
      Button:
        size_hint: .2, None
        height: '32dp'
        text: "Download"
        on_release: root.download_image(root.download_file)

<DownloadProgress>:
  title: 'Downloading {0}'.format(root.image)
  id: dlprogress
  BoxLayout:
    size: root.size
    pos: root.pos
    orientation: 'vertical'
    BoxLayout:
      Label:
        id: download_progress_counter
      ProgressBar:
        id: download_progress_bar
        max: 1
        value: 0
    BoxLayout:
      size_hint_y: None
      height: 30
      Button:
        text: "Cancel"
        on_release: root.cancel()
      Button:
        text: "Suspend"
        on_release: root.suspend()

<DownloadButton>:
  text: root.image
  size_hint_y: None
  height: 30
  on_release: app.root.DLISODialog.setDLImage(root.image)

<DownloadISODialog>:
  on_open: app.root.DLISODialog=self
  id: DLISODialog
  title: "Pick image"
  dl_image: None
  BoxLayout:
    size: root.size
    pos: root.pos
    orientation: "vertical"
    ScrollView:
      id: scroll_view
      size: self.size

    BoxLayout:
      size_hint_y: None
      height: 30
      Button:
        text: "Cancel"
        on_release: root.cancel()

<LoadISODialog>:
  title: filechooser.path
  choosen_file: None
  BoxLayout:
    size: root.size
    pos: root.pos
    orientation: "vertical"
    FileChooserListView:
      id: filechooser
      path: os.getcwd()+'/images'
    BoxLayout:
      size_hint_y: None
      height: 30
      Button:
        text: "Cancel"
        on_release: root.cancel()
      Button:
        text: "Load"
        on_release: root.load(filechooser.path, filechooser.selection)

<SaveDialog>:
  text_input: text_input
  BoxLayout:
    size: root.size
    pos: root.pos
    orientation: "vertical"
    FileChooserListView:
      id: filechooser
      path: os.getcwd()
      on_selection: test_input.text = self.selection and self.selection[0] or ''
    TextInput:
      id: text_input
      size_hint_y: None
      height: 30
      multiline: False
    BoxLayout:
      size_hint_y: None
      height: 30
      Button:
        text: "Cancel"
        on_release: root.cancel()
      Button:
        text: "Save"
        on_release: root.save(filechooser.path. text_input.text)

<OptionsPage>:
  name: "optionspage"
  Label:
    text: "Options Page"

<CommitPage>:
  name: "commitpage"
  Label:
    text: "Commit Page"

<BackupPage>:
  name: "backuppage"
  Label:
    text: "Backup Page"

